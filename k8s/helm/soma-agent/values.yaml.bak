# Default values for soma-agent-hub Helm chart.
# These values are used to render the templates under templates/.

# Global settings
global:
  imagePullPolicy: IfNotPresent
  namespace: soma-agent-hub   # renamed from soma-agent-hub

# Default hub port for gateway-api (used in service definition)
hubPort: 10000

# Kafka (Bitnami) configuration – KRaft mode
defaultKafka:
  enabled: true
  replicaCount: 3
  ## Enable KRaft (no Zookeeper)
  kraft:
    enabled: true
  resources:
    limits:
      cpu: "500m"
      memory: "512Mi"
    requests:
      cpu: "250m"
      memory: "256Mi"

# Kafka KRaft configuration - disabled for local development
kafka:
  enabled: false
  replicaCount: 3
  kraft:
    enabled: true
  resources:
    limits:
      cpu: "500m"
      memory: "512Mi"
    requests:
      cpu: "250m"
      memory: "256Mi"
  persistence:
    enabled: false

# Service definitions – each microservice can override these defaults
services:
  jobs:
    enabled: true
    replicaCount: 1
    image: "ghcr.io/somatechlat/soma-jobs:80e1d6f"
    imagePullPolicy: Never
    port: 1000
  somallm-provider:
    enabled: true
    replicaCount: 1
    image: "ghcr.io/somatechlat/soma-somallm-provider:80e1d6f"
    imagePullPolicy: Never
    port: 1001
  policy-engine:
    enabled: true
    replicaCount: 1
    image: "ghcr.io/somatechlat/soma-policy-engine:80e1d6f"
    imagePullPolicy: Never
    port: 1002
  memory-gateway:
    enabled: true
    replicaCount: 1
    image: "ghcr.io/somatechlat/soma-memory-gateway:80e1d6f"
    imagePullPolicy: Never
    port: 1003
  orchestrator:
    enabled: true
    replicaCount: 1
    image: "ghcr.io/somatechlat/soma-orchestrator:80e1d6f"
    imagePullPolicy: Never
    port: 1004
  settings-service:
    enabled: true
    replicaCount: 1
    image: "ghcr.io/somatechlat/soma-settings-service:80e1d6f"
    imagePullPolicy: Never
    port: 1005
  task-capsule-repo:
    enabled: true
    replicaCount: 1
    image: "ghcr.io/somatechlat/soma-task-capsule-repo:80e1d6f"
    imagePullPolicy: Never
    port: 1006
  gateway-api:
    enabled: true
    replicaCount: 1
    image: "ghcr.io/somatechlat/soma-gateway-api:80e1d6f"
    imagePullPolicy: Never
    port: 10000   # hub on 10000
  identity-service:
    enabled: true
    replicaCount: 1
    image: "ghcr.io/somatechlat/soma-identity-service:80e1d6f"
    imagePullPolicy: Never
    port: 1007
  constitution-service:
    enabled: true
    replicaCount: 1
    image: "ghcr.io/somatechlat/soma-constitution-service:80e1d6f"
    imagePullPolicy: Never
    port: 1008
  analytics-service:
    enabled: true
    replicaCount: 1
    image: "ghcr.io/somatechlat/soma-analytics-service:80e1d6f"
    imagePullPolicy: Never
    port: 1009
  billing-service:
    enabled: true
    replicaCount: 1
    image: "ghcr.io/somatechlat/soma-billing-service:80e1d6f"
    imagePullPolicy: Never
    port: 1010

# Ingress configuration
ingress:
  enabled: true
  className: nginx
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/rewrite-target: /$2
  hosts:
    - host: soma-agent-hub.local   # updated ingress host
      paths:
        - path: /jobs(/|$)(.*)
          pathType: Prefix
        - path: /policy(/|$)(.*)
          pathType: Prefix
        - path: /memory(/|$)(.*)
          pathType: Prefix
        - path: /orchestrator(/|$)(.*)
          pathType: Prefix
        - path: /settings(/|$)(.*)
          pathType: Prefix
        - path: /capsules(/|$)(.*)
          pathType: Prefix
